# Process 2


## 복습

### 동기식 입출력 vs 비동기식 입출력
- 동기식 입출력
    - 입출력 요청(I/O) 후 입출력 작업이 완료된 후에야 제어가 사용자 프로그램에 넘어감
    - 구현 방법 1 - I/O가 끝날 때까지 CPU를 낭비시킴. 매시점 하나의 I/O만 일어날 수 있음
    - 구현 방법 2 - I/O가 완료될 때까지 해당 프로그램에게서 CPU를 빼앗음. I/O 처리를 기다리는 줄에 그 프로그램을 줄 세움. 그리고 다른 프로그램에게 CPU를 줌
        좀더 효율적으로 CPU를 쓰기 위한 구현 방법.
        우리가 일반적으로 얘기하는 방법이 동기식 입출력 구현 방법 2 에 해당한다.
<br>

- 비동기식 입출력
    - I/O가 시작된 후 입출력 작업이 끝나기를 기다리지 않고 제어가 사용자 프로그램에게 즉시 넘어감  
          사용자 프로세스가 OS 통해 입출력한 후에 입출력이 진행되는 동안 그 프로세스가 곧바로 CPU를 잡아서 instruction 실행하는 걸 비동기식 입출력이라 함
<br>

---
<br>

## Thread 내용

- A thread(or lightweight process) is a basic unit of CPU utilization.
    - Thread는 하나의 프로세스 내부에 CPU 수행 단위가 여러개 있는 걸 의미한다
    - lightweight process 라고 하는 이유 : 프로세스를 별도로 두는 것보다 프로세스 안에 여러 개의 스레드를 두는 게 더 가볍기 때문
        우리가 동일한 일을 하는 여러 프로세스가 존재한다면, 별도의 프로세스를 만들기 위해서 별도의 주소 공간을 필요로 한다.
        이는 메모리 및 자원 낭비가 심하다. 그래서 같은 일을 하는 프로세스를 여러 개 띄어 놓고 싶다면 주소공간은 하나만, 즉 메모리 공간은 하나만 띄어 놓고 프로세스마다 다른 부분의 코드를 실행하도록 하자는 것이 스레드 개념!

- Thread의 구성
    - program counter
        CPU 수행을 위해, 즉 instruction을 실행하려면 현재 코드의 어느 부분을 실행하고 있는지를 나타내는 **program counter** 가 있어야함.
        그 CPU 에서 실행하면서 메모리에 레지스터 값을 세팅해놓고 실행하고 있을 것
        각 스레드마다, 즉 각 CPU 수행단위마다 현재 레지스터에 어떤 값을 넣고 프로그램 카운터가 코드 어느 부분을 가리키며 실행하고 있는지를 별도로 유지하고 있음.
    - register set
    - stack space
        스레드 하나가 코드 어느 부분을 실행하다가 함수호출을 하면 함수 호출하고 리턴하는 것과 관련된 정보를 스택에 쌓아야 함.
        따라서 CPU 수행단위가 여러개 존재하면 스택도 별도로 여러개 두어야 함.

- Thread가 동료 Thread와 공유하는 부분(=task)
    - code section
    - data section
    - OS resources
        프로세스 하나에서 공유할 수 있는 건 최대로 공유해야함
        예를 들면 메모리 주소 공간, 프로세스 상태, 프로세스가 사용하는 각종 자원들

- 전통적인 개념의 heavyweight process는 하나의 thread를 가지고 있는 task로 볼 수 있다.
<br>

### Thread의 장점
1. 다중 thread로 구성된 태스크 구조에서는 하나의 서버 thread가 blocked(waiting) 상태인 동안에도 동일한 태스크 내의 다른 thread가 실행(running)되어 빠른 처리를 할 수 있다.

        ex) 웹 브라우저에서 네이버를 본다 = 네트워크를 통해 웹 페이지를 읽어와야 함. 이것도 사실은 I/O 작업.
        웹페이지를 읽어오는 동안에 웹 브라우저는 blocked 상태다.
        이러면 사용자 입장에서 웹페이지를 다 읽어오기까지 화면에 아무것도 보여주지 못 한다.
        만약 웹 브라우저를 여러 개의 스레드를 통해 만들게 되면 하나의 스레드가 네이버 웹서버에서 그림 같은 걸 불러오는 동안에 
        또 다른 스레드가 이미 읽어온 텍스트라도 디스플레이(화면에 보여주면)할 경우, 
        사용자 입장에서는 결과를 일부라도 빨리 볼 수 있으므로 답답함이 덜 해질 수 있다.

2. 동일한 일을 수행하는 다중 thread가 협력하여 높은 처리율(throughput)과 성능 향상을 얻을 수 있다.
    
    같은 일을 별도의 프로세스로 만들어 놓으면 메모리나 자원 낭비가 심하다. 프로세스만의 독자적인 주소 공간을 만들어야 하고 그만큼 메모리를 차지하기 때문이다.

3. Thread를 사용하면 병렬성을 높일 수 있다.
    