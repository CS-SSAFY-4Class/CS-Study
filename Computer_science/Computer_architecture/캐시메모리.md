# Ⅰ. 캐시(Cache)에 대해

## 캐시란?
- 시스템 성능의 향상을 위해 자주 사용하는 값이나 데이터를 저장해놓는 임시 장소를 뜻함
- 재연산이나 불러올 필요없이 이미 저장된 데이터에 접근만 하면 돼서 속도가 빠름
- 가격이 비싸고 저장 공간이 작음

## 캐시가 사용되는 상황
- 반복적으로 결과를 반환하는 경우
- 데이터에 접근하는 시간이 오래걸리는 경우

## 캐시의 필요성

### 롱테일 법칙
- 20%의 요청(데이터)가 전체 시스템 리소스의 대부분을 차지한다는 법칙
- 저러한 대부분의 리소스를 차지하는 소수의 데이터를 Cache를 이용하여 불러오면 상당한 시스템 성능 향상 가능  

<br>

# Ⅱ. 캐시의 종류

## CPU 캐시

대용량의 메인 메모리 접근을 빠르게 하기 위해 CPU 칩 내부나 바로 옆에 탑재하는 작은 메모리

### CPU 캐시의 종류

- L1 : CPU 내부에 존재하는 캐시 메모리(cpu에서 가장 먼저 탐색)
- L2 : CPU와 RAM 사이에 존재
- L3 : 보통 메인보드에 존재함

![cache 계층](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FZdW35%2FbtqCbTDmFj5%2FAKbAUKiWseStnfD1Cd7gqk%2Fimg.png)

## 디스크 캐시

디스크에 입출력되는 데이터를 저장하는 작은 메모리

### 디스크 캐시의 용도

- 미리 읽기 : 첫 번째 섹터 이후 연이은 요청의 빠른 수행을 위해 뒷부분의 데이터를 미리 읽어 저장
- 속도 조절 : 디스크 암의 빠른 읽고 쓰기를 수행하기 위함
- 쓰기 가속 : 디스크에 저장할 데이터를 캐시에 넣고, 운영체제에 수행 종료를 보고  
  - 다른 작업으로 빠르게 넘어갈 수 있음
- 명령 큐 : 다른 명령을 수행하는 중 다른 여러개의 명령을 추가로 받을 수 있음
  - 이 명령 큐는 나중에 처리하기 위해 디스크 캐시에 저장  

<br>

# Ⅲ. 지역성

데이터 접근이 시간적, 공간적으로 가깝게 일어나는 것  
캐시가 효율적으로 동작을 위해 저장될 데이터가 가져야할 특성

## 시간적 지역성

- 가까운 미래에 한 번 접근된 데이터에 다시 접근할 가능성이 높은 것을 뜻함
- 메모리 상의 같은 주소에 여러 차례 읽기 쓰기를 수행 가능
- 상대적으로 작은 크기의 캐시를 사용해도 효율성 기대

## 공간적 지역성

- 특정 데이터와 가까운 주소가 순서대로 접근되었을 경우
- 캐시는 메모리 주소에 접근시 주소뿐만 아니라 해당 블록을 전부 캐시에 가져옴
- 메모리 주소를 정렬 순서로 접근한다면 캐시의 효율성이 크게 향상

<br>

# Ⅳ. 캐시 미스

Cache Hit : CPU가 요청한 데이터가 캐시에 있음  
Cache Miss : 요청한 데이터가 캐시에 없어 DRAM에서 가져옴

## 캐시 미스의 경우

Compulsory Miss
- 해당 메모리 주소를 처음 불러 나는 미스

Conflict miss
- 한 캐시 메무리 주소에 여러 데이터가 중복 할당되어 나는 
- 주소 할당의 문제 

Capacity miss
- 캐시 메모리의 공간이 부족해서 나는 미스
- 공간 문제

<br>

# Ⅴ. 캐시 동장 방식 및 구조

## Direct Mapped Cache

DRAM의 여러 주소가 캐시 메모리의의 한 주소에 대응되는 다대일 방식

- 가장 기본적인 구조
- 간단하고 빠르다는 장점
- 아래 사진처럼 같은 색깔의 데이터를 동시에 사용할 때 Conflict Miss가 발생함

![direct mapped cache](https://blog.kakaocdn.net/dn/ck10wu/btrRRBB4Nvy/zwoCkG63oCC8fgKlXQbVU1/img.png)

    00001, 01001, 10001, 11001은 001 캐시메모리에 저장됨

## Fully Associative Cache

비어있는 캐시 메모리가 있으면 마음대로 주소를 저장하는 방식
  
- 저장할 때는 간단하지만 찾을 때가 문제
- 조건이나 규칙이 없어 특정 캐시 set 안에 있는 모든 블럭을 검색해야함
- 특수한 메모리 구조를 사용해야하고 가격이 매우 비쌈

## Set Associative Cache

Direct + Fully 방식

- 특정 행을 지정 후, 그 행안의 어떤 열이든 비어있으면 저장
- Direct에 비해 검색 속도는 느리지만 저장이 빠름
- Fully에 비해 저장은 느리지만 검색이 빠름

### 참고
[망나니개발자](https://mangkyu.tistory.com/69)  
[Tech Interview](https://gyoogle.dev/blog/computer-science/computer-architecture/%EC%BA%90%EC%8B%9C%20%EB%A9%94%EB%AA%A8%EB%A6%AC.html)  
[위키백과](https://ko.wikipedia.org/wiki/%EC%BA%90%EC%8B%9C)  
[안녕](https://hi-guten-tag.tistory.com/282)  

